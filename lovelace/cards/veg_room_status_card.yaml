# =============================================================================
# VEG ROOM STATUS CARD - Veg Room Overview
# =============================================================================
# Shows veg room status with batch summary.
# Copy this card to any dashboard.
# =============================================================================

type: vertical-stack
cards:
  - type: markdown
    content: |
      ## ðŸŒ± Veg Room
      {% set s = 'sensor.veg_room_status' %}
      **{{ states(s) }}** | {{ state_attr(s, 'total_plants') }} plants

  - type: glance
    entities:
      - entity: sensor.veg_room_status
        name: Status
      - entity: sensor.veg_room_active_batches
        name: Batches

  - type: markdown
    content: >-
      {% set batches = state_attr('sensor.veg_room_status', 'batches_by_stage') %}
      {% if batches and batches | length > 0 %}
      | Stage | Batches | Plants |
      |-------|---------|--------|
      {% for stage, data in batches.items() %}
      | {{ stage }} | {{ data.count }} | {{ data.plants }} |
      {% endfor %}
      {% else %}
      No active batches
      {% endif %}

  - type: horizontal-stack
    cards:
      - type: button
        name: "ðŸŒ± Clones"
        tap_action:
          action: call-service
          service: grow_room_manager.add_veg_batch
          data:
            room_id: veg
            batch_name: "Clones {{ now().strftime('%b %d') }}"
            start_date: "{{ now().strftime('%Y-%m-%d') }}"
            stage: Clone
            plant_count: 24
            destination_room: f1
      - type: button
        name: "ðŸ‘‘ Mother"
        tap_action:
          action: call-service
          service: grow_room_manager.add_veg_batch
          data:
            room_id: veg
            batch_name: "Mother {{ now().strftime('%b %d') }}"
            start_date: "{{ now().strftime('%Y-%m-%d') }}"
            stage: Mother
            plant_count: 1
            destination_room: none
